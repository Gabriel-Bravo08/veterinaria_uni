<div class="container">
  <div class="row">
    <div class="col-md-6 agregar-cita">
      <form [formGroup]="citaForm" (ngSubmit)="onSubmit()">
        <h3 class="mb-4">Veterinaria El Amanecer</h3>

        <div class="form-group row" *ngFor="let field of [
          { id: 'mascota', label: 'Nombre de la Mascota:', type: 'text', placeholder: 'Ej: Toby' },
          { id: 'propietario', label: 'Nombre del DueÃ±o:', type: 'text', placeholder: 'Ej: Pedro' },
          { id: 'telefono', label: 'NÃºmero del TelÃ©fono:', type: 'number', placeholder: 'Ej: 7777-0000', maxlength: '8', minlength: '8' },
          { id: 'fecha', label: 'Fecha de la Cita:', type: 'date' },
          { id: 'hora', label: 'Hora de la Cita:', type: 'time' }
        ]">
          <div class="text-danger small" *ngIf="citaForm.get(field.id)?.touched && citaForm.get(field.id)?.hasError('required')">
            * Requerido.
          </div>
          <label class="col-sm-4 col-form-label">{{ field.label }}</label>
          <div class="col-sm-8 mb-3">
            <input class="form-control" [type]="field.type" [formControlName]="field.id"
              [placeholder]="field.placeholder || ''">
          </div>
        </div>

        <div class="form-group gap-1">
          <label class="col-sm-4 col-form-label">Agregar descripciÃ³n:</label>
          <div class="col-sm-8">
            <textarea class="form-control" formControlName="sintomas"></textarea>
          </div>
          <div class="text-danger small" *ngIf="citaForm.get('sintomas')?.touched && citaForm.get('sintomas')?.hasError('required')">
            * Requerido.
          </div>
        </div>

        <div class="form-group">
          <label class="col-sm-4 col-form-label">Foto de la Mascota:</label>
          <div class="col-sm-8">
            <input #fileInput class="form-control" type="file" (change)="onFileChange($event)">
          </div>
          <div class="text-danger small" *ngIf="citaForm.get('archivo')?.touched && citaForm.get('archivo')?.hasError('required')">
            * Requerido.
          </div>
        </div>

        <div class="form-group p-2">
          <button type="submit" class="btn btn-success w-100 d-block">
            {{ editando ? 'Guardar Cambios' : 'Crear Cita' }}
          </button>
        </div>

      </form>
    </div>

    <div class="col-md-6">
      <h3 class="mb-4">Administra tus Citas</h3>
      <ul class="lista-citas p-0">
        <li *ngFor="let cita of citas" class="card mb-4 p-3 shadow-sm border-0 rounded-3">
          <div class="row g-3 align-items-center">
            <!-- Imagen mascota -->
            <div class="col-md-3 text-center">
              <img *ngIf="cita.archivo" [src]="cita.archivo" alt="Foto Mascota" class="img-fluid border shadow-sm"
                style="max-width: 100px; height: 100px; object-fit: cover;" />
            </div>

            <!-- Detalles de la cita -->
            <div class="col-md-9">
              <h4 class="text-primary mb-1">
                DueÃ±o: {{ cita.propietario }}
              </h4>
              <h5><small class="text-muted">Mascota: {{ cita.mascota }}</small></h5>
              <p class="mb-1">
                ğŸ“… <strong>{{ cita.fecha }}</strong> a las <strong>{{ cita.hora }}</strong>
              </p>
              <p class="mb-1">ğŸ“ {{ cita.telefono }}</p>
              <p class="mb-2">ğŸ“ {{ cita.sintomas }}</p>

              <!-- Botones -->
              <div class="d-flex gap-2">
                <button (click)="editarCita(cita)" class="btn btn-sm btn-outline-primary">âœï¸ Editar</button>
                <button (click)="eliminarCita(cita.id)" class="btn btn-sm btn-outline-danger">ğŸ—‘ï¸ Eliminar</button>
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>